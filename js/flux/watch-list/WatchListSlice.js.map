{"version":3,"sources":["../../../src/flux/watch-list/WatchListSlice.js"],"names":["STORAGE_KEY","DIALOG_CAPTION","WATCH_SAVED","MsgWatch","WATCH_PREV","findGroup","Logic","addItem","removeItem","dragDropItem","dragDropList","dragDropGroup","addGroup","renameGroup","deleteGroup","createList","renameList","deleteList","WatchListSlice","watchList","WatchDefault","isWatchEdited","initWatchList","LocalForage","getItem","then","value","trigger","CAT","UPDATE_WATCH_BROWSER","getWatchList","getWatchGroups","groups","getWatchListsByGroup","groupCaption","group","lists","onAddWatchItem","item","_onEditWatch","WAT","ADD_ITEM","isAutoSaveOnAdd","onSaveWatch","isShowDialog","onRemoveWatchItem","option","_onDragDrop","result","isDone","showAlertDialog","onDragDropItem","onDragDropList","onDragDropGroup","setItem","onShowModalDialog","MD","MSG","caption","descr","error","console","warn","forActionType","EDIT_WATCH_COMPLETED","EDIT_WATCH_FAILED","messages","message","onAddGroup","ADD_GROUP","onRenameGroup","RENAME_GROUP","onDeleteGroup","DELETE_GROUP","onCreateList","CREATE_LIST","onRenameList","RENAME_LIST","onDeleteList","DELETE_LIST"],"mappings":"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","sourcesContent":["import LocalForage from 'localforage';\r\n\r\nimport { T as CAT } from '../actions/ComponentActions';\r\n\r\nimport { WatchActionTypes as WAT } from '../actions/WatchActions';\r\nimport WatchDefault from '../../constants/WatchDefault';\r\nimport { ModalDialog as MD }  from '../../constants/Type';\r\nimport MsgWatch from '../../constants/MsgWatch';\r\n\r\nimport Logic from './Logic';\r\n\r\nconst STORAGE_KEY = 'WATCH_LIST_WORDS'\r\n    , DIALOG_CAPTION ='Watch List:';\r\n\r\nconst { WATCH_SAVED, WATCH_PREV } = MsgWatch;\r\nconst {\r\n  findGroup, addItem, removeItem,\r\n  dragDropItem, dragDropList, dragDropGroup,\r\n  addGroup, renameGroup, deleteGroup,\r\n  createList, renameList, deleteList\r\n} = Logic;\r\n\r\nconst WatchListSlice = {\r\n\r\n  watchList: WatchDefault,\r\n  isWatchEdited: false,\r\n\r\n  initWatchList(){\r\n    LocalForage.getItem(STORAGE_KEY).then((value) => {\r\n      this.watchList = value || WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n    .catch(() => {\r\n      this.watchList = WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n  },\r\n  getWatchList(){\r\n    return this.watchList;\r\n  },\r\n  getWatchGroups(){\r\n    return this.watchList.groups;\r\n  },\r\n  getWatchListsByGroup(groupCaption){\r\n    const group = findGroup(this.watchList, groupCaption);\r\n    if (!group) { return []; }\r\n    return group.lists;\r\n  },\r\n\r\n  onAddWatchItem(item){\r\n    this._onEditWatch(\r\n      addItem(this.watchList, item), WAT.ADD_ITEM\r\n    );\r\n    if (this.isAutoSaveOnAdd){\r\n      this.onSaveWatch({ isShowDialog: false })\r\n    }\r\n  },\r\n  onRemoveWatchItem(option){\r\n    removeItem(this.watchList, option);\r\n    this.isWatchEdited = true;\r\n    this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n  },\r\n\r\n\r\n  _onDragDrop(result){\r\n    if (result.isDone){\r\n       this.isWatchEdited = true;\r\n       this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    } else {\r\n      this.showAlertDialog(result);\r\n    }\r\n  },\r\n\r\n  onDragDropItem(option){\r\n    this._onDragDrop(dragDropItem(this.watchList, option) );\r\n  },\r\n  onDragDropList(option){\r\n    this._onDragDrop(dragDropList(this.watchList, option) );\r\n  },\r\n  onDragDropGroup(option){\r\n    this._onDragDrop(dragDropGroup(this.watchList, option));\r\n  },\r\n\r\n\r\n  onSaveWatch({ isShowDialog=true } = {}){\r\n    if (this.isWatchEdited){\r\n       LocalForage.setItem(STORAGE_KEY , this.watchList)\r\n          .then(()=>{\r\n             this.isWatchEdited = false;\r\n             if (isShowDialog) {\r\n               this.onShowModalDialog(MD.MSG, {\r\n                  caption: DIALOG_CAPTION,\r\n                  descr: WATCH_SAVED\r\n               })\r\n             }\r\n          })\r\n          .catch((error) => {\r\n             /*eslint-disable no-console*/\r\n             console.warn(error);\r\n             /*eslint-enable no-console*/\r\n          })\r\n    } else {\r\n       this.onShowModalDialog(MD.MSG, {\r\n          caption: DIALOG_CAPTION,\r\n          descr: WATCH_PREV\r\n       })\r\n    }\r\n  },\r\n\r\n  _onEditWatch(result, forActionType){\r\n    if (result.isDone){\r\n      this.isWatchEdited = true;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n      this.trigger(WAT.EDIT_WATCH_COMPLETED, {forActionType});\r\n    } else {\r\n      this.trigger(WAT.EDIT_WATCH_FAILED, {\r\n          messages:[result.message],\r\n          forActionType\r\n      });\r\n    }\r\n  },\r\n  onAddGroup(option){\r\n    this._onEditWatch(\r\n      addGroup(this.watchList, option),\r\n      WAT.ADD_GROUP\r\n    );\r\n  },\r\n  onRenameGroup(option){\r\n    this._onEditWatch(\r\n      renameGroup(this.watchList, option),\r\n      WAT.RENAME_GROUP\r\n    );\r\n  },\r\n  onDeleteGroup(option){\r\n    this._onEditWatch(\r\n      deleteGroup(this.watchList, option),\r\n      WAT.DELETE_GROUP\r\n    );\r\n  },\r\n\r\n  onCreateList(option){\r\n    this._onEditWatch(\r\n      createList(this.watchList, option),\r\n      WAT.CREATE_LIST\r\n    );\r\n  },\r\n  onRenameList(option){\r\n    this._onEditWatch(\r\n      renameList(this.watchList, option),\r\n      WAT.RENAME_LIST\r\n    );\r\n  },\r\n  onDeleteList(option){\r\n    this._onEditWatch(\r\n      deleteList(this.watchList, option),\r\n      WAT.DELETE_LIST\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default WatchListSlice\r\n"],"file":"WatchListSlice.js"}