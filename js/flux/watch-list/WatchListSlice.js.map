{"version":3,"sources":["../../../src/flux/watch-list/WatchListSlice.js"],"names":["STORAGE_KEY","DIALOG_CAPTION","WATCH_SAVED","MsgWatch","WATCH_PREV","findGroup","Logic","addItem","removeItem","dragDropItem","dragDropList","dragDropGroup","addGroup","renameGroup","deleteGroup","createList","renameList","deleteList","WatchListSlice","watchList","WatchDefault","isWatchEdited","initWatchList","LocalForage","getItem","then","value","trigger","CAT","UPDATE_WATCH_BROWSER","getWatchList","getWatchGroups","groups","getWatchListsByGroup","groupCaption","group","lists","onAddWatchItem","item","_onEditWatch","WAT","ADD_ITEM","onRemoveWatchItem","option","_onDragDrop","result","isDone","showAlertDialog","onDragDropItem","onDragDropList","onDragDropGroup","onSaveWatch","setItem","onShowModalDialog","MD","MSG","caption","descr","error","console","warn","forActionType","EDIT_WATCH_COMPLETED","EDIT_WATCH_FAILED","messages","message","onAddGroup","ADD_GROUP","onRenameGroup","RENAME_GROUP","onDeleteGroup","DELETE_GROUP","onCreateList","CREATE_LIST","onRenameList","RENAME_LIST","onDeleteList","DELETE_LIST"],"mappings":"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","sourcesContent":["import LocalForage from 'localforage';\r\n\r\nimport { T as CAT } from '../actions/ComponentActions';\r\n\r\nimport { WatchActionTypes as WAT } from '../actions/WatchActions';\r\nimport WatchDefault from '../../constants/WatchDefault';\r\nimport { ModalDialog as MD }  from '../../constants/Type';\r\nimport MsgWatch from '../../constants/MsgWatch';\r\n\r\nimport Logic from './Logic';\r\n\r\nconst STORAGE_KEY = 'WATCH_LIST_WORDS'\r\n    , DIALOG_CAPTION ='Watch List:';\r\n\r\nconst { WATCH_SAVED, WATCH_PREV } = MsgWatch;\r\nconst {\r\n  findGroup, addItem, removeItem,\r\n  dragDropItem, dragDropList, dragDropGroup,\r\n  addGroup, renameGroup, deleteGroup,\r\n  createList, renameList, deleteList\r\n} = Logic;\r\n\r\nconst WatchListSlice = {\r\n\r\n  watchList: WatchDefault,\r\n  isWatchEdited: false,\r\n\r\n  initWatchList(){\r\n    LocalForage.getItem(STORAGE_KEY).then((value) => {\r\n      this.watchList = value || WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n    .catch(() => {\r\n      this.watchList = WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n  },\r\n  getWatchList(){\r\n    return this.watchList;\r\n  },\r\n  getWatchGroups(){\r\n    return this.watchList.groups;\r\n  },\r\n  getWatchListsByGroup(groupCaption){\r\n    const group = findGroup(this.watchList, groupCaption);\r\n    if (!group) { return []; }\r\n    return group.lists;\r\n  },\r\n\r\n  onAddWatchItem(item){\r\n    this._onEditWatch(\r\n      addItem(this.watchList, item), WAT.ADD_ITEM\r\n    );\r\n  },\r\n  onRemoveWatchItem(option){\r\n    removeItem(this.watchList, option);\r\n    this.isWatchEdited = true;\r\n    this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n  },\r\n\r\n\r\n  _onDragDrop(result){\r\n    if (result.isDone){\r\n       this.isWatchEdited = true;\r\n       this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    } else {\r\n      this.showAlertDialog(result);\r\n    }\r\n  },\r\n\r\n  onDragDropItem(option){\r\n    this._onDragDrop(dragDropItem(this.watchList, option) );\r\n  },\r\n  onDragDropList(option){\r\n    this._onDragDrop(dragDropList(this.watchList, option) );\r\n  },\r\n  onDragDropGroup(option){\r\n    this._onDragDrop(dragDropGroup(this.watchList, option));\r\n  },\r\n\r\n\r\n  onSaveWatch(){\r\n    if (this.isWatchEdited){\r\n       LocalForage.setItem(STORAGE_KEY , this.watchList)\r\n          .then(()=>{\r\n             this.isWatchEdited = false;\r\n             this.onShowModalDialog(MD.MSG, {\r\n                caption: DIALOG_CAPTION,\r\n                descr: WATCH_SAVED\r\n             })\r\n          })\r\n          .catch((error) => {\r\n             /*eslint-disable no-console*/\r\n             console.warn(error);\r\n             /*eslint-enable no-console*/\r\n          })\r\n    } else {\r\n       this.onShowModalDialog(MD.MSG, {\r\n          caption: DIALOG_CAPTION,\r\n          descr: WATCH_PREV\r\n       })\r\n    }\r\n  },\r\n\r\n  _onEditWatch(result, forActionType){\r\n    if (result.isDone){\r\n      this.isWatchEdited = true;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n      this.trigger(WAT.EDIT_WATCH_COMPLETED, {forActionType});\r\n    } else {\r\n      this.trigger(WAT.EDIT_WATCH_FAILED, {\r\n          messages:[result.message],\r\n          forActionType\r\n      });\r\n    }\r\n  },\r\n  onAddGroup(option){\r\n    this._onEditWatch(\r\n      addGroup(this.watchList, option),\r\n      WAT.ADD_GROUP\r\n    );\r\n  },\r\n  onRenameGroup(option){\r\n    this._onEditWatch(\r\n      renameGroup(this.watchList, option),\r\n      WAT.RENAME_GROUP\r\n    );\r\n  },\r\n  onDeleteGroup(option){\r\n    this._onEditWatch(\r\n      deleteGroup(this.watchList, option),\r\n      WAT.DELETE_GROUP\r\n    );\r\n  },\r\n\r\n  onCreateList(option){\r\n    this._onEditWatch(\r\n      createList(this.watchList, option),\r\n      WAT.CREATE_LIST\r\n    );\r\n  },\r\n  onRenameList(option){\r\n    this._onEditWatch(\r\n      renameList(this.watchList, option),\r\n      WAT.RENAME_LIST\r\n    );\r\n  },\r\n  onDeleteList(option){\r\n    this._onEditWatch(\r\n      deleteList(this.watchList, option),\r\n      WAT.DELETE_LIST\r\n    );\r\n  }\r\n    \r\n}\r\n\r\nexport default WatchListSlice\r\n"],"file":"WatchListSlice.js"}