{"version":3,"sources":["../../../src/flux/watch-list/WatchListSlice.js"],"names":["STORAGE_KEY","DIALOG_CAPTION","WATCH_SAVED","WATCH_PREV","findGroup","addItem","removeItem","dragDropItem","dragDropList","dragDropGroup","addGroup","renameGroup","deleteGroup","createList","renameList","deleteList","WatchListSlice","watchList","isWatchEdited","initWatchList","getItem","then","value","trigger","UPDATE_WATCH_BROWSER","catch","getWatchList","getWatchGroups","groups","getWatchListsByGroup","groupCaption","group","lists","onAddWatchItem","item","_onEditWatch","ADD_ITEM","onRemoveWatchItem","option","_onDragDrop","result","isDone","showAlertDialog","onDragDropItem","onDragDropList","onDragDropGroup","onSaveWatch","setItem","onShowModalDialog","MSG","caption","descr","error","console","warn","forActionType","EDIT_WATCH_COMPLETED","EDIT_WATCH_FAILED","messages","message","onAddGroup","ADD_GROUP","onRenameGroup","RENAME_GROUP","onDeleteGroup","DELETE_GROUP","onCreateList","CREATE_LIST","onRenameList","RENAME_LIST","onDeleteList","DELETE_LIST"],"mappings":"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","file":"WatchListSlice.js","sourcesContent":["import LocalForage from 'localforage';\r\n\r\nimport { T as CAT } from '../actions/ComponentActions';\r\n\r\nimport { WatchActionTypes as WAT } from '../actions/WatchActions';\r\nimport WatchDefault from '../../constants/WatchDefault';\r\nimport { ModalDialog as MD }  from '../../constants/Type';\r\nimport MsgWatch from '../../constants/MsgWatch';\r\n\r\nimport Logic from './Logic';\r\n\r\nconst STORAGE_KEY = 'WATCH_LIST_WORDS'\r\n    , DIALOG_CAPTION ='Watch List:';\r\n\r\nconst { WATCH_SAVED, WATCH_PREV } = MsgWatch;\r\nconst {\r\n  findGroup, addItem, removeItem,\r\n  dragDropItem, dragDropList, dragDropGroup,\r\n  addGroup, renameGroup, deleteGroup,\r\n  createList, renameList, deleteList\r\n} = Logic;\r\n\r\nconst WatchListSlice = {\r\n\r\n  watchList: WatchDefault,\r\n  isWatchEdited: false,\r\n\r\n  initWatchList(){\r\n    LocalForage.getItem(STORAGE_KEY).then((value) => {\r\n      this.watchList = value || WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n    .catch(() => {\r\n      this.watchList = WatchDefault;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    })\r\n  },\r\n  getWatchList(){\r\n    return this.watchList;\r\n  },\r\n  getWatchGroups(){\r\n    return this.watchList.groups;\r\n  },\r\n  getWatchListsByGroup(groupCaption){\r\n    const group = findGroup(this.watchList, groupCaption);\r\n    if (!group) { return []; }\r\n    return group.lists;\r\n  },\r\n\r\n  onAddWatchItem(item){\r\n    this._onEditWatch(\r\n      addItem(this.watchList, item), WAT.ADD_ITEM\r\n    );\r\n  },\r\n  onRemoveWatchItem(option){\r\n    removeItem(this.watchList, option);\r\n    this.isWatchEdited = true;\r\n    this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n  },\r\n\r\n\r\n  _onDragDrop(result){\r\n    if (result.isDone){\r\n       this.isWatchEdited = true;\r\n       this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n    } else {\r\n      this.showAlertDialog(result);\r\n    }\r\n  },\r\n\r\n  onDragDropItem(option){\r\n    this._onDragDrop(dragDropItem(this.watchList, option) );\r\n  },\r\n  onDragDropList(option){\r\n    this._onDragDrop(dragDropList(this.watchList, option) );\r\n  },\r\n  onDragDropGroup(option){\r\n    this._onDragDrop(dragDropGroup(this.watchList, option));\r\n  },\r\n\r\n\r\n  onSaveWatch(){\r\n    if (this.isWatchEdited){\r\n       LocalForage.setItem(STORAGE_KEY , this.watchList)\r\n          .then(()=>{\r\n             this.isWatchEdited = false;\r\n             this.onShowModalDialog(MD.MSG, {\r\n                caption: DIALOG_CAPTION,\r\n                descr: WATCH_SAVED\r\n             })\r\n          })\r\n          .catch((error) => {\r\n             /*eslint-disable no-console*/\r\n             console.warn(error);\r\n             /*eslint-enable no-console*/\r\n          })\r\n    } else {\r\n       this.onShowModalDialog(MD.MSG, {\r\n          caption: DIALOG_CAPTION,\r\n          descr: WATCH_PREV\r\n       })\r\n    }\r\n  },\r\n\r\n  _onEditWatch(result, forActionType){\r\n    if (result.isDone){\r\n      this.isWatchEdited = true;\r\n      this.trigger(CAT.UPDATE_WATCH_BROWSER, this.watchList);\r\n      this.trigger(WAT.EDIT_WATCH_COMPLETED, {forActionType});\r\n    } else {\r\n      this.trigger(WAT.EDIT_WATCH_FAILED, {\r\n          messages:[result.message],\r\n          forActionType\r\n      });\r\n    }\r\n  },\r\n  onAddGroup(option){\r\n    this._onEditWatch(\r\n      addGroup(this.watchList, option),\r\n      WAT.ADD_GROUP\r\n    );\r\n  },\r\n  onRenameGroup(option){\r\n    this._onEditWatch(\r\n      renameGroup(this.watchList, option),\r\n      WAT.RENAME_GROUP\r\n    );\r\n  },\r\n  onDeleteGroup(option){\r\n    this._onEditWatch(\r\n      deleteGroup(this.watchList, option),\r\n      WAT.DELETE_GROUP\r\n    );\r\n  },\r\n\r\n  onCreateList(option){\r\n    this._onEditWatch(\r\n      createList(this.watchList, option),\r\n      WAT.CREATE_LIST\r\n    );\r\n  },\r\n  onRenameList(option){\r\n    this._onEditWatch(\r\n      renameList(this.watchList, option),\r\n      WAT.RENAME_LIST\r\n    );\r\n  },\r\n  onDeleteList(option){\r\n    this._onEditWatch(\r\n      deleteList(this.watchList, option),\r\n      WAT.DELETE_LIST\r\n    );\r\n  }\r\n    \r\n}\r\n\r\nexport default WatchListSlice\r\n"]}