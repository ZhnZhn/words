{"version":3,"sources":["../../../src/flux/stores/ItemSlice.js"],"names":["Logic","addItem","slice","config","itemConf","paneId","configs","paneSlice","Array","isArray","_isItem","id","unshift","findIndex","c","isItem","_isConfigs","removeItem","filter","undefined","removeItems","removeItemsUnder","_undexIndex","ItemSlice","items","word","onLoadItem","option","showPane","triggerLoading","LOADING","onLoadItemCompleted","result","limitRemaining","_option","trigger","LOAD_ITEM_COMPLETED","LOADING_COMPLETE","onLoadItemFailed","showModalDialog","LOADING_FAILED","onRemoveItem","_options","onRemoveItems","onRemoveItemsUnder"],"mappings":";;;;;;AACA;;AACA;;;;AACA;;;;AAGA,IAAMA,QAAQ;AACZC,SADY,mBACJC,KADI,EACGC,MADH,EACWC,QADX,EACoB;AAAA,2BACFA,QADE,CACtBC,MADsB;AAAA,QACtBA,MADsB,oCACf,QADe;;AAE9BF,WAAOE,MAAP,GAAgBA,MAAhB;;AAEM,oBAAYH,MAAMG,MAAN,KAAiB,EAA7B;AAAA,QACCC,OADD,GACaC,SADb,CACCD,OADD;;AAEN,QAAIE,MAAMC,OAAN,CAAcH,OAAd,CAAJ,EAA4B;AAC1B,UAAI,CAACN,MAAMU,OAAN,CAAcJ,OAAd,EAAuBH,OAAOQ,EAA9B,CAAL,EAAwC;AACtCL,gBAAQM,OAAR,CAAgBT,MAAhB;AACD;AACF,KAJD,MAIO;AACLD,YAAMG,MAAN,IAAgB;AACdC,iBAAS,CAAEH,MAAF;AADK,OAAhB;AAGD;AACD,WAAO;AACLG,eAASJ,MAAMG,MAAN,EAAcC,OADlB;AAELK,UAAIN;AAFC,KAAP;AAID,GApBW;AAsBZK,SAtBY,mBAsBJJ,OAtBI,EAsBKK,EAtBL,EAsBQ;AAClB,WAAQH,MAAMC,OAAN,CAAcH,OAAd,KACNA,QAAQO,SAAR,CAAkB;AAAA,aAAKC,EAAEH,EAAF,KAASA,EAAd;AAAA,KAAlB,MAAwC,CAAC,CADnC,GAEJ,IAFI,GAGJ,KAHJ;AAID,GA3BW;AA6BZI,QA7BY,kBA6BLb,KA7BK,EA6BEG,MA7BF,EA6BUM,EA7BV,EA6Ba;AACjB,oBAAYT,MAAMG,MAAN,KAAiB,EAA7B;AAAA,QACCC,OADD,GACaC,SADb,CACCD,OADD;;AAEN,WAAON,MAAMU,OAAN,CAAcJ,OAAd,EAAuBK,EAAvB,CAAP;AACD,GAjCW;AAmCZK,YAnCY,sBAmCDd,KAnCC,EAmCK;AACf,WAAOA,SACFM,MAAMC,OAAN,CAAcP,MAAMI,OAApB,CADL;AAED,GAtCW;AAwCZW,YAxCY,sBAwCDf,KAxCC,EAwCMC,MAxCN,EAwCa;AAAA,QACfE,MADe,GACAF,MADA,CACfE,MADe;AAAA,QACPM,EADO,GACAR,MADA,CACPQ,EADO;AAAA,QAEjBJ,SAFiB,GAELL,MAAMG,MAAN,CAFK;;AAGvB,QAAK,KAAKW,UAAL,CAAgBT,SAAhB,CAAL,EAAkC;AAChCL,YAAMG,MAAN,EAAcC,OAAd,GAAwBC,UAAUD,OAAV,CACrBY,MADqB,CACd;AAAA,eAAKJ,EAAEH,EAAF,KAASA,EAAd;AAAA,OADc,CAAxB;AAEA,aAAO;AACLL,iBAASJ,MAAMG,MAAN,EAAcC,OADlB;AAELK,YAAIN;AAFC,OAAP;AAID,KAPD,MAOO;AACL,aAAOc,SAAP;AACD;AACF,GArDW;AAuDZC,aAvDY,uBAuDAlB,KAvDA,EAuDOG,MAvDP,EAuDc;AACxB,QAAME,YAAYL,MAAMG,MAAN,CAAlB;AACA,QAAIE,SAAJ,EAAe;AACbA,gBAAUD,OAAV,GAAoB,EAApB;AACD;AACF,GA5DW;AA8DZe,kBA9DY,4BA8DKnB,KA9DL,EA8DsB;AAAA,QAAVC,MAAU,uEAAH,EAAG;AAAA,QACxBE,MADwB,GACTF,MADS,CACxBE,MADwB;AAAA,QAChBM,EADgB,GACTR,MADS,CAChBQ,EADgB;AAAA,QAE1BJ,SAF0B,GAEdL,MAAMG,MAAN,CAFc;;AAGhC,QAAK,KAAKW,UAAL,CAAgBT,SAAhB,CAAL,EAAkC;AAChC,UAAMe,cAAcf,UAAUD,OAAV,CACjBO,SADiB,CACP;AAAA,eAAKC,EAAEH,EAAF,KAASA,EAAd;AAAA,OADO,CAApB;AAEAJ,gBAAUD,OAAV,GAAoBC,UAAUD,OAAV,CAChBJ,KADgB,CACVoB,cAAY,CADF,CAApB;AAEA,aAAO;AACJhB,iBAASC,UAAUD,OADf;AAEJK,YAAIN;AAFA,OAAP;AAID;AACD,WAAOc,SAAP;AACD;AA5EW,CAAd;;AA+EA,IAAMI,YAAY;AAChBC,SAAO,EADS;;AAGhBT,QAHgB,kBAGTV,MAHS,EAGDoB,IAHC,EAGK;AACnB,WAAOzB,MAAMe,MAAN,CAAa,KAAKS,KAAlB,EAAyBnB,MAAzB,EAAiCoB,IAAjC,CAAP;AACD,GALe;AAOhBC,YAPgB,wBAOK;AAAA,QAAVC,MAAU,uEAAH,EAAG;;AACnB,+BAAiBC,QAAjB,CAA0BD,OAAOvB,QAAjC;AACA,SAAKyB,cAAL,CAAoB,kBAAIC,OAAxB;AACD,GAVe;AAWhBC,qBAXgB,+BAWIC,MAXJ,EAWYL,MAXZ,EAWmB;AAAA,QAEzBxB,MAFyB,GAGvB6B,MAHuB,CAEzB7B,MAFyB;AAAA,QAEjBC,QAFiB,GAGvB4B,MAHuB,CAEjB5B,QAFiB;AAAA,QAIzB6B,cAJyB,GAINN,MAJM,CAIzBM,cAJyB;;AAKjC,QAAI9B,MAAJ,EAAY;AACV,UAAM+B,UAAUlC,MAAMC,OAAN,CAAc,KAAKuB,KAAnB,EAA0BrB,MAA1B,EAAkCC,QAAlC,CAAhB;AACA,WAAK+B,OAAL,CAAa,eAAEC,mBAAf,EAAoCF,OAApC;AACD;AACD,SAAKL,cAAL,CAAoB,kBAAIQ,gBAAxB,EAA0CJ,cAA1C;AACD,GArBe;AAsBhBK,kBAtBgB,4BAsBCX,MAtBD,EAsBQ;AACtB,+BAAiBY,eAAjB,CAAiC,cAAjC,EAAiDZ,MAAjD;AACA,SAAKE,cAAL,CAAoB,kBAAIW,cAAxB;AACD,GAzBe;AA2BhBC,cA3BgB,wBA2BHtC,MA3BG,EA2BI;AAClB,QAAMuC,WAAW1C,MAAMiB,UAAN,CAAiB,KAAKO,KAAtB,EAA6BrB,MAA7B,CAAjB;AACA,QAAIuC,QAAJ,EAAc;AACZ,WAAKP,OAAL,CAAa,eAAEC,mBAAf,EAAoCM,QAApC;AACD;AACF,GAhCe;AAiChBC,eAjCgB,yBAiCFtC,MAjCE,EAiCK;AACnBL,UAAMoB,WAAN,CAAkB,KAAKI,KAAvB,EAA8BnB,MAA9B;AACA,SAAK8B,OAAL,CAAa,eAAEC,mBAAf,EAAoC;AAClC9B,eAAS,EADyB,EACrBK,IAAIN;AADiB,KAApC;AAGD,GAtCe;AAuChBuC,oBAvCgB,8BAuCGzC,MAvCH,EAuCU;AACxB,QAAM+B,UAAUlC,MAAMqB,gBAAN,CAAuB,KAAKG,KAA5B,EAAmCrB,MAAnC,CAAhB;AACA,QAAI+B,OAAJ,EAAY;AACV,WAAKC,OAAL,CAAa,eAAEC,mBAAf,EAAoCF,OAApC;AACD;AACF;AA5Ce,CAAlB;;kBA+CeX,S","file":"ItemSlice.js","sourcesContent":["\r\nimport { T } from '../actions/ItemActions'\r\nimport ComponentActions from '../actions/ComponentActions'\r\nimport { T as LPT } from '../actions/LoadingActions'\r\n\r\n\r\nconst Logic = {\r\n  addItem(slice, config, itemConf){\r\n    const { paneId='paneId' } = itemConf;\r\n    config.paneId = paneId\r\n\r\n    const paneSlice = slice[paneId] || {}\r\n       , { configs } = paneSlice;\r\n    if (Array.isArray(configs)) {\r\n      if (!Logic._isItem(configs, config.id)) {\r\n        configs.unshift(config)\r\n      }\r\n    } else {\r\n      slice[paneId] = {\r\n        configs: [ config ]\r\n      };\r\n    }\r\n    return {\r\n      configs: slice[paneId].configs,\r\n      id: paneId\r\n    };\r\n  },\r\n\r\n  _isItem(configs, id){\r\n    return  Array.isArray(configs) &&\r\n      configs.findIndex(c => c.id === id) !== -1\r\n      ? true\r\n      : false;\r\n  },\r\n\r\n  isItem(slice, paneId, id){\r\n    const paneSlice = slice[paneId] || {}\r\n       , { configs } = paneSlice;\r\n    return Logic._isItem(configs, id);\r\n  },\r\n\r\n  _isConfigs(slice){\r\n    return slice\r\n      && Array.isArray(slice.configs);\r\n  },\r\n\r\n  removeItem(slice, config){\r\n    const { paneId, id } = config\r\n        , paneSlice = slice[paneId];\r\n    if ( this._isConfigs(paneSlice) ) {\r\n      slice[paneId].configs = paneSlice.configs\r\n        .filter(c => c.id !== id )\r\n      return {\r\n        configs: slice[paneId].configs,\r\n        id: paneId\r\n      }\r\n    } else {\r\n      return undefined;\r\n    }\r\n  },\r\n\r\n  removeItems(slice, paneId){\r\n    const paneSlice = slice[paneId]\r\n    if (paneSlice) {\r\n      paneSlice.configs = []\r\n    }\r\n  },\r\n\r\n  removeItemsUnder(slice, config={}){\r\n    const { paneId, id } = config\r\n        , paneSlice = slice[paneId];\r\n    if ( this._isConfigs(paneSlice) ) {\r\n      const _undexIndex = paneSlice.configs\r\n        .findIndex(c => c.id === id )\r\n      paneSlice.configs = paneSlice.configs\r\n         .slice(_undexIndex+1)\r\n      return {\r\n         configs: paneSlice.configs,\r\n         id: paneId\r\n       };\r\n    }\r\n    return undefined;\r\n  }\r\n};\r\n\r\nconst ItemSlice = {\r\n  items: {},\r\n\r\n  isItem(paneId, word) {\r\n    return Logic.isItem(this.items, paneId, word);\r\n  },\r\n\r\n  onLoadItem(option={}){\r\n    ComponentActions.showPane(option.itemConf)\r\n    this.triggerLoading(LPT.LOADING)\r\n  },\r\n  onLoadItemCompleted(result, option){\r\n    const {\r\n            config, itemConf\r\n          } = result\r\n        , { limitRemaining } = option;\r\n    if (config) {\r\n      const _option = Logic.addItem(this.items, config, itemConf);\r\n      this.trigger(T.LOAD_ITEM_COMPLETED, _option)\r\n    }\r\n    this.triggerLoading(LPT.LOADING_COMPLETE, limitRemaining)\r\n  },\r\n  onLoadItemFailed(option){\r\n    ComponentActions.showModalDialog('ALERT_DIALOG', option)\r\n    this.triggerLoading(LPT.LOADING_FAILED)\r\n  },\r\n\r\n  onRemoveItem(config){\r\n    const _options = Logic.removeItem(this.items, config)\r\n    if (_options) {\r\n      this.trigger(T.LOAD_ITEM_COMPLETED, _options)\r\n    }  \r\n  },\r\n  onRemoveItems(paneId){\r\n    Logic.removeItems(this.items, paneId)\r\n    this.trigger(T.LOAD_ITEM_COMPLETED, {\r\n      configs: [], id: paneId\r\n    })\r\n  },\r\n  onRemoveItemsUnder(config){\r\n    const _option = Logic.removeItemsUnder(this.items, config)\r\n    if (_option){\r\n      this.trigger(T.LOAD_ITEM_COMPLETED, _option)\r\n    }\r\n  }\r\n};\r\n\r\nexport default ItemSlice\r\n"]}