{"version":3,"sources":["../../../src/components/zhn-dnd/DndOnlyX.jsx"],"names":["BORDER_LEFT","DRAG_START_BORDER_LEFT","LONG_TOUCH","_getClientX","ev","targetTouches","changedTouches","clientX","DndOnlyX","props","_dragTouchEnd","_isDragTouch","_isMoveStart","preventDefault","persist","_clientX","_dX","Math","abs","onDragTouchEnd","_dragTouchEndStyle","currentTarget","clearTimeout","_dragTouchId","_dragStartStyle","bind","_dragEndStyle","_dragStart","_dragEnd","_startDragTouch","_dragTouchStart","_dragTouchMove","_node","style","removeProperty","setProperty","dataTransfer","effectAllowed","dropEffect","onDragEnd","_preventDefault","_dragTouchStartStyle","node","setTimeout","_dragTouchMoveStyle","dX","_opacity","right","opacity","_startMoveX","isBack","render","children","Component"],"mappings":"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","sourcesContent":["import { Component } from 'react'\r\n\r\nconst BORDER_LEFT = 'border-left';\r\nconst DRAG_START_BORDER_LEFT = \"4px solid #D64336\";\r\n\r\nconst LONG_TOUCH = 1000;\r\n\r\nconst _getClientX = (ev) => {\r\n  const { targetTouches, changedTouches } = ev;\r\n  return (targetTouches && targetTouches[0])\r\n    ? targetTouches[0].clientX\r\n    : (changedTouches && changedTouches[0])\r\n        ? changedTouches[0].clientX\r\n        : 0;\r\n};\r\n\r\nclass DndOnlyX extends Component {\r\n  /*\r\n  static propTypes = {\r\n    style: PropTypes.object,\r\n\r\n    onDragEnd: PropTypes.func,\r\n    onDragTouchEnd: PropTypes.func\r\n  }\r\n  */\r\n\r\n  constructor(props){\r\n    super(props)\r\n    this.clientX = 0\r\n    this._isDragTouch = false\r\n\r\n    this._dragStartStyle = this._dragStartStyle.bind(this)\r\n    this._dragEndStyle = this._dragEndStyle.bind(this)\r\n    this._dragStart = this._dragStart.bind(this)\r\n    this._dragEnd = this._dragEnd.bind(this)\r\n\r\n    this._startDragTouch = this._startDragTouch.bind(this)\r\n    this._dragTouchStart = this._dragTouchStart.bind(this)\r\n    this._dragTouchMove = this._dragTouchMove.bind(this)\r\n    this._dragTouchEnd = this._dragTouchEnd.bind(this)\r\n\r\n  }\r\n\r\n  _dragStartStyle(ev) {\r\n    if (this._node){\r\n      this._node.style.removeProperty(BORDER_LEFT)\r\n    }\r\n    this._node = ev.currentTarget\r\n    this._node.style.setProperty(BORDER_LEFT, DRAG_START_BORDER_LEFT)\r\n  }\r\n  _dragEndStyle() {\r\n    this._node.style.removeProperty(BORDER_LEFT)\r\n    this._node = null\r\n  }\r\n\r\n  _dragStart(ev) {\r\n    ev.persist()\r\n    this.clientX = ev.clientX\r\n    this._dragStartStyle(ev)\r\n    ev.dataTransfer.effectAllowed=\"move\"\r\n    ev.dataTransfer.dropEffect=\"move\"\r\n  }\r\n  _dragEnd(ev) {\r\n    ev.preventDefault()\r\n    ev.persist()\r\n    this._dragEndStyle()\r\n    this.props.onDragEnd(Math.abs(\r\n      this.clientX - ev.clientX\r\n    ))\r\n  }\r\n\r\n  _preventDefault(ev){\r\n    ev.preventDefault()\r\n  }\r\n\r\n  _dragTouchStartStyle(node) {\r\n    node.style.setProperty(BORDER_LEFT, DRAG_START_BORDER_LEFT)\r\n  }\r\n  _startDragTouch(node) {\r\n    this._isDragTouch = true\r\n    this._dragTouchStartStyle(node)\r\n  }\r\n   _dragTouchStart(ev){\r\n     const node = ev.currentTarget;\r\n     this._dragTouchId = setTimeout(\r\n       () => this._startDragTouch(node),\r\n       LONG_TOUCH\r\n     )\r\n   }\r\n\r\n   _dragTouchMoveStyle(node, dX){\r\n     const _opacity = (1 - (0.5*Math.abs(dX))/60);\r\n     node.style.right = dX + 'px'\r\n     node.style.opacity = _opacity\r\n   }\r\n   _dragTouchMove(ev) {\r\n     if (this._isDragTouch) {\r\n       ev.persist()\r\n       const _clientX = _getClientX(ev);\r\n       if (_clientX) {\r\n         if (!this._isMoveStart){\r\n           this.clientX = this._startMoveX = _clientX\r\n           this._isMoveStart = true\r\n         } else {\r\n           const _dX = this._startMoveX - _clientX;\r\n           this._dragTouchMoveStyle(ev.currentTarget, _dX)\r\n         }\r\n       }\r\n     }\r\n   }\r\n\r\n   _dragTouchEndStyle(node, isBack){\r\n     node.style.removeProperty(BORDER_LEFT)\r\n     if (isBack) {\r\n       node.style.right = '0px'\r\n       node.style.opacity = 1\r\n     }\r\n   }\r\n   _dragTouchEnd = (ev) => {\r\n     if (this._isDragTouch) {\r\n       if (this._isMoveStart) {\r\n         ev.preventDefault()\r\n         ev.persist()\r\n         const _clientX = _getClientX(ev)\r\n             , _dX = Math.abs(this.clientX - _clientX);\r\n        if (this.props.onDragTouchEnd(_dX)){\r\n          this._dragTouchEndStyle(ev.currentTarget, true)\r\n        }\r\n         this._isMoveStart = false\r\n       } else {\r\n         this._dragTouchEndStyle(ev.currentTarget)\r\n       }\r\n       this._isDragTouch = false\r\n     } else {\r\n       clearTimeout(this._dragTouchId)\r\n     }\r\n   }\r\n\r\n  render(){\r\n    const { style, children } = this.props;\r\n    return (\r\n      <div\r\n        style={style}\r\n        draggable={true}\r\n        onDragStart={this._dragStart}\r\n        onDragEnd={this._dragEnd}\r\n\r\n        onDrop={this._preventDefault}\r\n        onDragOver={this._preventDefault}\r\n        onDragEnter={this._preventDefault}\r\n        onDragLeave={this._preventDefault}\r\n\r\n        onTouchStart={this._dragTouchStart}\r\n        onTouchMove={this._dragTouchMove}\r\n        onTouchEnd={this._dragTouchEnd}\r\n      >\r\n        {children}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DndOnlyX\r\n"],"file":"DndOnlyX.js"}