{"version":3,"sources":["../../../src/components/zhn-moleculs/ModalDialog.jsx"],"names":["CL","D","D_ACTIONS","BT_DIV","S","BT_ROOT","color","CL2","SHOWING","HIDING","S2","INIT","display","opacity","transform","_getPrevFocusedElement","_prevFocused","document","_prevFocusedZhn","activeElement","_hasFocusFn","ref","current","focus","_hClickDialog","event","stopPropagation","ModalDialog","isShow","className","style","isWithButton","caption","captionStyle","commandButtons","withoutClose","children","onClose","_refRootDiv","_refPrevFocused","_hKeyDown","target","keyCode","initialWasClosed","_className","_style","_className2"],"mappings":"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","sourcesContent":["import React, { useRef, useCallback, useEffect } from 'react';\r\n//import PropTypes from \"prop-types\";\r\n\r\nimport useClassAnimation from '../zhn-hooks/useClassAnimation'\r\n\r\nimport A from '../Comp'\r\n\r\nconst CL = {\r\n  D: 'modal-dialog',\r\n  D_ACTIONS: 'modal-dialog__actions',\r\n  BT_DIV: 'bt-flat__div'\r\n};\r\nconst S = {\r\n  BT_ROOT: {\r\n    color: '#3270b4'\r\n  }\r\n};\r\n\r\nconst CL2 = {\r\n  SHOWING : 'dialog show-popup',\r\n  HIDING : 'hide-popup'\r\n};\r\nconst S2 = {\r\n  INIT: {\r\n    display: 'none'\r\n  },\r\n  SHOWING: {\r\n    display: 'block'\r\n  },\r\n  HIDING: {\r\n    opacity: 0,\r\n    transform: 'scaleY(0)'\r\n  }\r\n};\r\n\r\nconst _getPrevFocusedElement = () => {\r\n  const _prevFocused = document._prevFocusedZhn;\r\n  if (_prevFocused) {\r\n    return document._prevFocusedZhn = void 0, _prevFocused;\r\n  }\r\n  return document.activeElement;\r\n};\r\n\r\nconst _hasFocusFn = ref =>\r\n  typeof ((ref || {}).current || {}).focus === 'function';\r\n\r\nconst _hClickDialog = (event) => {\r\n  event.stopPropagation()\r\n};\r\n\r\nconst ModalDialog = ({\r\n  isShow,\r\n  className=CL.D,\r\n  style,\r\n  isWithButton=true,\r\n  //isFocusClose=true,\r\n  caption, captionStyle,\r\n  commandButtons, withoutClose,\r\n  children, onClose\r\n}) => {\r\n  const _refRootDiv = useRef()\r\n  , _refPrevFocused = useRef()\r\n  , _hKeyDown = useCallback((event) => {\r\n       if (_refRootDiv\r\n         && event.target === _refRootDiv.current\r\n         && event.keyCode === 27) {\r\n           onClose(event)\r\n       }\r\n     }, [])\r\n  , {\r\n    className:_className, style:_style\r\n  } = useClassAnimation({\r\n    isShow, CL: CL2, S: S2,\r\n    initialWasClosed: false\r\n  })\r\n  , _className2 = _className\r\n      ? `${className} ${_className}`\r\n      : className;\r\n\r\n  useEffect(() => {\r\n    if(isShow) {\r\n      _refPrevFocused.current = _getPrevFocusedElement()\r\n    }\r\n  }, [isShow])\r\n  useEffect(() => {\r\n    if (isShow && _hasFocusFn(_refRootDiv)) {\r\n      _refRootDiv.current.focus()\r\n    }\r\n  }, [isShow])\r\n  useEffect(() => {\r\n    if (_style === S2.HIDING && _hasFocusFn(_refPrevFocused) ) {\r\n      _refPrevFocused.current.focus()\r\n    }\r\n  })\r\n  return (\r\n    <div\r\n       ref={_refRootDiv}       \r\n       tabIndex=\"0\"\r\n       className={_className2}\r\n       style={{...style, ..._style}}\r\n       onClick={_hClickDialog}\r\n       onKeyDown={_hKeyDown}\r\n    >\r\n       <A.BrowserCaption\r\n          rootStyle={captionStyle}\r\n          caption={caption}\r\n          onClose={onClose}\r\n       />\r\n       <div>\r\n         {children}\r\n       </div>\r\n       {isWithButton && <div className={CL.D_ACTIONS}>\r\n         {commandButtons}\r\n         { !withoutClose &&\r\n            <A.FlatButton\r\n              //ref={_refBtClose}\r\n              rootStyle={S.BT_ROOT}\r\n              clDiv={CL.BT_DIV}\r\n              caption=\"Close\"\r\n              isPrimary={true}\r\n              onClick={onClose}\r\n            />\r\n         }\r\n       </div>}\r\n   </div>\r\n  );\r\n}\r\n\r\nexport default ModalDialog\r\n"],"file":"ModalDialog.js"}