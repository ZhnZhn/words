{"version":3,"sources":["../../../src/components/zhn-m-input/TextField.jsx"],"names":["DB_TOUCH_PERIOD","CL","SELECT","LABEL","DIV","INPUT","INPUT_LINE","INPUT_MSG_ERR","S","LABEL_TO_INPUT","transform","LABEL_ON_ERROR","color","LINE_ERROR","borderBottom","KEY","textDecoration","_isFn","fn","_isStr","str","_crCaption","caption","accessKey","cPrefix","keyIndex","toLowerCase","indexOf","substring","cKey","cTail","TextField","props","_handleClearInput","setState","value","_handleDbTouch","ev","_ms","Date","now","_firstTouch","_handleFocusInput","isFocus","forceUpdate","_handleBlurInput","_handleInputChange","event","target","onTest","isOnTest","isPassTest","_handleKeyDown","keyCode","isOnEnter","onEnter","_ref","n","inputNode","initValue","_value","state","UNSAFE_componentWillReceiveProps","nextProps","render","rootStyle","labelStyle","inputStyle","errorMsg","restProps","_labelStyle","_labelErrStyle","_lineStyle","getValue","String","trim","setValue","focus","setSelectionRange","len","length","Component","defaultProps","spellCheck"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\n//import PropsTypes from 'prop-types'\r\n\r\n//import CaptionInput from '../zhn-atoms/CaptionInput'\r\n\r\nconst DB_TOUCH_PERIOD = 500\r\n\r\nconst CL = {\r\n  SELECT: 'm-select',\r\n  LABEL: 'm-select__label',\r\n  DIV: 'm-textfield-input__div',\r\n  INPUT: 'm-textfield-input',\r\n  INPUT_LINE: 'm-input__line',\r\n  INPUT_MSG_ERR: 'm-input__msg-err'\r\n};\r\n\r\nconst S = {\r\n  LABEL_TO_INPUT: {\r\n     transform: 'scale(1) translate(0px, -6px)'\r\n  },\r\n  LABEL_ON_ERROR: {\r\n    color: '#f44336'\r\n  },\r\n  LINE_ERROR: {\r\n    borderBottom: '2px solid #F44336'\r\n  },\r\n  KEY: {\r\n    textDecoration: 'underline'\r\n  }\r\n\r\n};\r\n\r\n\r\nconst _isFn = fn => typeof fn === 'function';\r\nconst _isStr = str => typeof str === 'function';\r\n\r\nconst _crCaption = (caption, accessKey) => {\r\n  if (!accessKey) {\r\n    return { cPrefix: caption };\r\n  }\r\n  const keyIndex = caption.toLowerCase()\r\n    .indexOf(accessKey.toLowerCase());\r\n  if (keyIndex === -1){\r\n    return { cPrefix: caption };\r\n  }\r\n  return {\r\n    cPrefix: caption.substring(0, keyIndex),\r\n    cKey: caption.substring(keyIndex, keyIndex+1),\r\n    cTail: caption.substring(keyIndex+1)\r\n  };\r\n};\r\n\r\nclass TextField extends Component {\r\n  /*\r\n  static propTypes = {\r\n    rootStyle: PropTypes.object,\r\n    caption: PropTypes.string,\r\n    labelStyle: PropTypes.object,\r\n    inputStyle: PropTypes.object,\r\n    errorMsg: PropTypes.string,\r\n    initValue: PropTypes.string,\r\n    accessKey: PropTypes.string,\r\n    spellCheck: PropTypes.bool,\r\n    onTest: PropTypes.func,\r\n    onEnter: PropTypes.func,\r\n  }\r\n  */\r\n\r\n  static defaultProps = {\r\n    caption: '',\r\n    accessKey: '',\r\n    spellCheck: false,\r\n  }\r\n\r\n  constructor(props){\r\n    super(props)\r\n    const { onTest, onEnter, initValue } = props;\r\n\r\n    this.isFocus = false;\r\n    this.isOnTest = _isFn(onTest)\r\n    this.isOnEnter = _isFn(onEnter)\r\n\r\n    this._firstTouch = 0;\r\n\r\n    const _value = initValue || ''\r\n    this.state = {\r\n      value: _value,\r\n      isPassTest: this.isOnTest\r\n         ? onTest(_value) : true\r\n    }\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps){\r\n    /* update new initValue from parent component */\r\n    if (this.props !== nextProps\r\n      && this.props.initValue !== nextProps.initValue ) {\r\n        this.setState({\r\n          value: nextProps.initValue || ''\r\n        })\r\n    }\r\n  }\r\n\r\n\r\n  _handleClearInput = () => {\r\n    this.setState({ value: '' })\r\n  }\r\n\r\n  _handleDbTouch = (ev) => {\r\n    const _ms = Date.now();\r\n    if (this._firstTouch) {\r\n      if (_ms - this._firstTouch<DB_TOUCH_PERIOD) {\r\n        this._firstTouch = 0\r\n        this._handleClearInput()\r\n      } else {\r\n        this._firstTouch = _ms\r\n      }\r\n    } else {\r\n      this._firstTouch = _ms\r\n    }\r\n  }\r\n\r\n  _handleFocusInput = () => {\r\n    this.isFocus = true\r\n    this.forceUpdate()\r\n  }\r\n  _handleBlurInput = () => {\r\n    this.isFocus = false\r\n    this.forceUpdate()\r\n  }\r\n\r\n  _handleInputChange = (event) => {\r\n    const { value } = event.target\r\n        , { onTest  } = this.props;\r\n    if (this.isOnTest) {\r\n      this.setState({\r\n        value, isPassTest: onTest(value)\r\n      })\r\n    } else {\r\n      this.setState({ value })\r\n    }\r\n  }\r\n _handleKeyDown = (event) => {\r\n   const { keyCode } = event;\r\n   if (keyCode === 46){\r\n     this.setState({ value: '' })\r\n   } else if (keyCode === 13 && this.isOnEnter) {\r\n     this.props.onEnter(event.target.value)\r\n   }\r\n }\r\n\r\n _ref = n => this.inputNode = n\r\n\r\n  render(){\r\n    const {\r\n            rootStyle, caption,\r\n            labelStyle, inputStyle,\r\n            accessKey,\r\n            errorMsg='',\r\n            ...restProps\r\n          } = this.props\r\n        , { value, isPassTest } = this.state\r\n        , _labelStyle = (value || this.isFocus)\r\n            ? void 0\r\n            : S.LABEL_TO_INPUT\r\n        , _labelErrStyle = (isPassTest)\r\n            ? void 0\r\n            : S.LABEL_ON_ERROR\r\n        , _lineStyle = (isPassTest)\r\n            ? void 0\r\n            : S.LINE_ERROR\r\n       , { cPrefix, cKey, cTail } = _crCaption(caption, accessKey);\r\n\r\n    return (\r\n      <div\r\n        className={CL.SELECT}\r\n        style={rootStyle}\r\n        //onDoubleClick={this._handleClearInput}\r\n        onTouchStart={this._handleDbTouch}\r\n      >\r\n        <label\r\n          className={CL.LABEL}\r\n          style={{...labelStyle, ..._labelStyle, ..._labelErrStyle}}\r\n         >\r\n          {cPrefix}\r\n          <span style={S.KEY}>{cKey}</span>\r\n          {cTail}\r\n        </label>\r\n        <div className={CL.DIV}>\r\n          <input\r\n            ref={this._ref}\r\n            type=\"text\"\r\n            className={CL.INPUT}\r\n            style={inputStyle}\r\n            value={value}\r\n            autoComplete=\"new-text\"\r\n            autoCorrect=\"off\"\r\n            autoCapitalize=\"off\"\r\n            translate=\"false\"\r\n            accessKey={accessKey}\r\n            {...restProps}\r\n            onFocus={this._handleFocusInput}\r\n            onBlur={this._handleBlurInput}\r\n            onChange={this._handleInputChange}\r\n            onKeyDown={this._handleKeyDown}\r\n          />\r\n          <div className={CL.INPUT_LINE} style={_lineStyle} />\r\n          { _lineStyle && <div className={CL.INPUT_MSG_ERR}>{errorMsg}</div>}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getValue(){\r\n    return String(this.state.value).trim();\r\n  }\r\n  setValue(str){\r\n    if (_isStr(str)){\r\n      this.setState({ value: str })\r\n    }\r\n  }\r\n  focus(){\r\n    if (this.inputNode) {\r\n      this.inputNode.focus()\r\n      if (_isFn(this.inputNode.setSelectionRange)) {\r\n        const len = this.state.value.length\r\n        this.inputNode.setSelectionRange(len, len)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default TextField\r\n"],"file":"TextField.js"}